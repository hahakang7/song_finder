<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>비교 결과</title>

    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .container {
            display: flex;
            gap: 40px;
        }

        .column {
            width: 33%;
        }

        ul {
            list-style: none;
            padding: 0;
        }

        li {
            margin-bottom: 10px;
        }

        img {
            vertical-align: middle;
            margin-right: 6px;
        }

        form {
            display: inline;
        }

        button {
            margin-left: 8px;
        }

        .dumped {
            color: gray;
            text-decoration: line-through;
        }
    </style>
</head>
<body>

<h2>비교 결과</h2>

<hr>

<div>

    <!-- 아티스트 구독 -->
    <div>
        <span>아티스트:</span>

        <span th:if="${artistSubscribed}">
            ✅ 구독됨
        </span>

        <form th:if="${!artistSubscribed}"
              th:action="@{/subscribe/artist}"
              method="post"
              style="display:inline">

            <input type="hidden" name="channelId" th:value="${channelId}">
            <input type="hidden" name="artistName" th:value="${artistName}">
            <input type="hidden" name="playlistId" th:value="${playlistId}">

            <button type="submit">아티스트 구독</button>
        </form>
    </div>

    <!-- 플레이리스트 구독 -->
    <div>
        <span>플레이리스트:</span>

        <span th:if="${playlistSubscribed}">
            ✅ 구독됨
        </span>

        <form th:if="${!playlistSubscribed}"
              th:action="@{/subscribe/playlist}"
              method="post"
              style="display:inline">

            <input type="hidden" name="playlistId" th:value="${playlistId}">
            <input type="hidden" name="playlistTitle" th:value="${playlistTitle}">
            <input type="hidden" name="channelId" th:value="${channelId}">

            <button type="submit">플레이리스트 구독</button>
        </form>
    </div>

</div>

<hr>


<p>
    제외됨: <b th:text="${dumpedCount}">0</b> /
    없는 곡: <b th:text="${missingCount}">0</b> /
    포함됨: <b th:text="${containedCount}">0</b>
</p>

<div class="container">

    <!-- ===================== -->
    <!-- Dumped -->
    <!-- ===================== -->
    <div class="column">
        <h3>제외한 곡</h3>
        <ul>
            <li th:each="item : ${items}"
                th:if="${item.status.name() == 'DUMPED'}"
                class="dumped">

                <img th:if="${item.thumbnailUrl != null}"
                     th:src="${item.thumbnailUrl}" alt="thumb"/>

                <span th:text="${item.normalizedTitle}"></span>

                <!-- Undo -->
                <form th:action="@{/dump/undo}" method="post">
                    <input type="hidden" name="channelId" th:value="${channelId}">
                    <input type="hidden" name="playlistId" th:value="${playlistId}">
                    <input type="hidden" name="title" th:value="${item.normalizedTitle}">
                    <button type="submit">되돌리기</button>
                </form>
            </li>
        </ul>
    </div>

    <!-- ===================== -->
    <!-- Missing -->
    <!-- ===================== -->
    <div class="column">
        <h3>플레이리스트에 없는 곡</h3>
        <ul>
            <li th:each="item : ${items}"
                th:if="${item.status.name() == 'MISSING'}">

                <img th:if="${item.thumbnailUrl != null}"
                     th:src="${item.thumbnailUrl}" alt="thumb"/>

                <span th:text="${item.normalizedTitle}"></span>

                <!-- Dump -->
                <form th:action="@{/dump/add}" method="post">
                    <input type="hidden" name="channelId" th:value="${channelId}">
                    <input type="hidden" name="playlistId" th:value="${playlistId}">
                    <input type="hidden" name="title" th:value="${item.normalizedTitle}">
                    <button type="submit">제외</button>
                </form>
            </li>
        </ul>
    </div>

    <!-- ===================== -->
    <!-- Contained -->
    <!-- ===================== -->
    <div class="column">
        <h3>이미 포함된 곡</h3>
        <ul>
            <li th:each="item : ${items}"
                th:if="${item.status.name() == 'CONTAINED'}">

                <img th:if="${item.thumbnailUrl != null}"
                     th:src="${item.thumbnailUrl}" alt="thumb"/>

                <span th:text="${item.normalizedTitle}"></span>
            </li>
        </ul>
    </div>

</div>

<hr>

<a href="/playlists">플레이리스트 선택으로 돌아가기</a>

</body>
</html>
