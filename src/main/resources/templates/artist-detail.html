<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>아티스트</title>
    <style>
        body { font-family: Arial, sans-serif; }
        form { display: inline; }
        button { margin-left: 6px; }
        small { color: gray; }
        .card { padding: 12px; border: 1px solid #ddd; margin: 12px 0; }
        img { vertical-align: middle; margin-right: 8px; }
    </style>
</head>
<body>

<h2>아티스트 정보</h2>

<div class="card">
    <div>
        <img th:if="${artistThumbnailUrl != null}" th:src="${artistThumbnailUrl}" alt="thumb">
        <b th:text="${artistName}">Artist Name</b>
        <span style="color: gray;" th:text="'(' + ${channelId} + ')'"></span>
    </div>

    <div style="margin-top: 8px;">
        <span th:if="${artistSubscribed}">
            ✅ 구독됨
            <small th:if="${artistLastSyncedAt != null}">
                (마지막:
                <span th:text="${#temporals.format(artistLastSyncedAt, 'yyyy-MM-dd HH:mm')}"></span>)
            </small>
        </span>
        <span th:if="${!artistSubscribed}">
            ❌ 구독 안 됨
        </span>
    </div>

    <div style="margin-top: 8px;">
        <!-- 토글 -->
        <form th:action="@{/subscribe/artist/toggle}" method="post">
            <input type="hidden" name="channelId" th:value="${channelId}">
            <input type="hidden" name="artistName" th:value="${artistName}">
            <button type="submit"
                    th:text="${artistSubscribed} ? '구독 해지' : '구독'">
                구독
            </button>
        </form>

        <!-- 재동기화: 구독된 경우만 -->
        <form th:if="${artistSubscribed}"
              th:action="@{/subscribe/artist/resync}" method="post">
            <input type="hidden" name="channelId" th:value="${channelId}">
            <input type="hidden" name="artistName" th:value="${artistName}">
            <button type="submit">재동기화</button>
        </form>
    </div>
</div>

<!-- 비교로 연결: 이 아티스트를 선택한 상태로 플레이리스트 목록으로 이동 -->
<div>
    <a th:href="@{/playlists(channelId=${channelId})}">이 아티스트로 비교하기</a>
</div>

</body>
</html>
