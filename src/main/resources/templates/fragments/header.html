<div th:fragment="topHeader" style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #ddd; padding:10px 0; margin-bottom:16px;">
    <div style="display:flex; align-items:center; gap:14px;">
        <a href="/" style="font-weight:700; text-decoration:none; color:#111;">ðŸŽµ SongFinder</a>
        <nav style="display:flex; gap:12px; font-size:14px;">
            <a href="/playlists" data-protected="true">Playlist Management</a>
            <a href="/artists" data-protected="true">Subscribed Artist Management</a>
            <a href="/artists/register" data-protected="true">Register Artist</a>
        </nav>
    </div>

    <div th:if="${!isAuthed}">
        <button type="button" onclick="window.openLoginModal()">Login</button>
    </div>

    <div th:if="${isAuthed}" style="position:relative;">
        <button type="button" onclick="window.toggleProfileMenu()" style="display:flex; align-items:center; gap:8px;">
            <span style="display:inline-flex; width:24px; height:24px; border-radius:999px; background:#4f46e5; color:white; align-items:center; justify-content:center; font-size:12px;">D</span>
            <span>Demo User</span>
        </button>

        <div id="profileMenu" style="display:none; position:absolute; right:0; top:36px; min-width:160px; border:1px solid #ddd; background:white; padding:8px;">
            <button type="button" onclick="window.showComingSoon()" style="width:100%; text-align:left; margin-bottom:6px;">My Info</button>
            <form action="/auth/logout" method="post" style="margin:0;">
                <input type="hidden" name="redirect" value="/">
                <button type="submit" style="width:100%; text-align:left;">Logout</button>
            </form>
        </div>
    </div>
</div>

<script th:fragment="headerScript">
    function toggleProfileMenu() {
        const menu = document.getElementById('profileMenu');
        if (!menu) return;
        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    }

    function showComingSoon() {
        alert('Coming soon');
    }

    window.toggleProfileMenu = toggleProfileMenu;
    window.showComingSoon = showComingSoon;

    document.addEventListener('click', function (e) {
        const menu = document.getElementById('profileMenu');
        if (!menu) return;
        if (!menu.parentElement.contains(e.target)) {
            menu.style.display = 'none';
        }
    });
</script>
